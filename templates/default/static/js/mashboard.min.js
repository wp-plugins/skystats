jQuery(window).ready(function(s){"use strict";var t=s("#skystats-cards-loading-container");s.get(ajaxurl,{action:"skystats_ajax_licensing_api_query",query:"check_license"},function(a){if(a=s.parseJSON(a),"error"===a.responseType){var e=s("#skystats-page-error-container"),n=e.find("p");switch(a["responseContext"]){case"missing_license_key":n.html(skystats_mashboard["trans"]["licensing"]["missing_license_key"]);break;case"license_expired":n.html(skystats_mashboard["trans"]["licensing"]["license_expired"]);break;case"malformed_license_key":n.html(skystats_mashboard["trans"]["licensing"]["malformed_license_key"]);break;case"http_error":n.html(skystats_mashboard["trans"]["licensing"]["http_error"]);break;case"error_initialising_request":n.html(skystats_mashboard["trans"]["licensing"]["error_initializing_request"]);break;case"error_executing_request":n.html(skystats_mashboard["trans"]["licensing"]["error_executing_request"]);break;case"malformed_response":n.html(skystats_mashboard["trans"]["licensing"]["malformed_request"]);break;case"license_site_inactive":n.html(skystats_mashboard["trans"]["licensing"]["license_site_inactive"]);break;case"license_site_inactive_no_activations_left":n.html(skystats_mashboard["trans"]["licensing"]["license_site_inactive_no_activations_left"]);break;case"license_inactive":n.html(skystats_mashboard["trans"]["licensing"]["license_inactive"]);break;case"license_inactive_no_activations_left":n.html(skystats_mashboard["trans"]["licensing"]["license_inactive_no_activations_left"]);break;case"license_disabled":n.html(skystats_mashboard["trans"]["licensing"]["license_disabled"]);break;case"license_unknown_status":default:n.html(skystats_mashboard["trans"]["licensing"]["license_unknown_status"])}t.fadeOut(400,function(){e.fadeIn()})}else s.get(ajaxurl,{action:"skystats_ajax_get_mashboard_card_positions"},function(a){a=s.parseJSON(a),s.each(a,function(t,a){var e="#"+t;s.each(a,function(t,a){s("#"+a).appendTo(e)})}),t.fadeOut(400,function(){var t={dateFormat:"mm/dd/yy",changeMonth:!0,changeYear:!0,minDate:-30,maxDate:"today",onSelect:function(t,a){t!==a.lastVal&&s(this).change()}},a=s("#start_date"),e=s("#end_date");a.datepicker(t),e.datepicker(t),a.datepicker("setDate","-29d"),e.datepicker("setDate","today"),s("#skystats-date-range-container").fadeIn(),s("#skystats-date-range-notice-container").fadeIn(),s(".skystats-card").fadeIn();var n=s(".skystats-mashboard-vote-now");n.addClass("skystats-disabled"),s.get(ajaxurl,{action:"skystats_ajax_get_integration_vote_totals"},function(t){t=s.parseJSON(t),null!=t.result&&s.each(t.result,function(t,a){var e="#skystats-"+t+"-integration-vote-totals-container",n=s(e),r=n.find(">strong"),i=n.find(">span");r.text(a),i.text(1===parseInt(a)?skystats_mashboard["trans"]["integration_vote"]:skystats_mashboard["trans"]["integration_votes"])}),s(".skystats-integration-vote-totals-loading-container").fadeOut(400,function(){s(".skystats-integration-vote-totals-container").fadeIn(),n.removeClass("skystats-disabled")})}),n.off("click"),n.on("click",function(t){t.preventDefault();var a=s(this);if(!a.hasClass("skystats-disabled")){var e=a.prev(),n=e.find(">strong"),r=e.find(">span"),i=s(".skystats-loading-container").first().clone();i.attr("id",""),i.addClass("skystats-integration-vote-loading-container"),i.insertBefore(a),i.show(),a.hide();var o=a.attr("data-integration");if(s("#skystats-mashboard-"+o+"-vote-result-message").remove().end(),s("#skystats-mashboard-"+o+"-vote-result-sub-message").remove(),"true"!==skystats_mashboard["voting_opted_in"]){var c=s('<p id="skystats-mashboard-'+o+'-vote-result-message" class="skystats-mashboard-vote-result-message">'+skystats_mashboard["trans"]["voting_not_opted_in_message"]+"</p>"+'<p id="skystats-mashboard-'+o+'-vote-result-sub-message" class="skystats-mashboard-vote-result-sub-message">'+skystats_mashboard["trans"]["voting_not_opted_in_sub_message"]+"</p>");return c.insertBefore(a),a.parent().children().first().remove(),a.remove(),void i.remove()}var c=s('<p id="skystats-mashboard-'+o+'-vote-result-message" class="skystats-mashboard-vote-result-message">'+skystats_mashboard["trans"]["integration_vote_result_message"]+"</p>"+'<p id="skystats-mashboard-'+o+'-vote-result-sub-message" class="skystats-mashboard-vote-result-sub-message">'+skystats_mashboard["trans"]["integration_vote_result_sub_message"]+"</p>");s.post(ajaxurl,{action:"skystats_ajax_vote_for_integration",integration:o},function(){var s=parseInt(n.text())+1;n.text(s),r.text(s>1?skystats_mashboard["trans"]["integration_votes"]:skystats_mashboard["trans"]["integration_vote"]),c.insertBefore(a),a.parent().children().first().remove(),a.remove(),i.remove()})}}),initTooltips();var r=getIntegrations("mashboard"),i=r.length;makeCardsSortable(r,i),s("#date_range").click(function(){for(var s=!1,t=0;i>t;++t)r[t].updateDataTabData(s),s=!0}),s(window).resize(function(){for(var s=0;i>s;++s)r[s].resizeChart()});for(var o=0;i>o;++o)r[o].loadDataTabData()})})})});