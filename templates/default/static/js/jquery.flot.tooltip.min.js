!function(t){var e={tooltip:!1,tooltipOpts:{id:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:!0,lines:!1,onHover:function(){},$compat:!1}},i=function(t){this.tipPosition={x:0,y:0},this.init(t)};i.prototype.init=function(e){function i(t){var i={};i.x=t.pageX,i.y=t.pageY,e.setTooltipPosition(i)}function s(i,s,n){var a=function(t,e,i,s){return Math.sqrt((i-t)*(i-t)+(s-e)*(s-e))},r=function(t,e,i,s,o,n,r){if(!r||(r=function(t,e,i,s,o,n){if("undefined"!=typeof i)return{x:i,y:e};if("undefined"!=typeof s)return{x:t,y:s};var a,r=-1/((n-s)/(o-i));return{x:a=(o*(t*r-e+s)+i*(t*-r+e-n))/(r*(o-i)+s-n),y:r*a-r*t+e}}(t,e,i,s,o,n),r.x>=Math.min(i,o)&&r.x<=Math.max(i,o)&&r.y>=Math.min(s,n)&&r.y<=Math.max(s,n))){var p=s-n,l=o-i,d=i*n-s*o;return Math.abs(p*t+l*e+d)/Math.sqrt(p*p+l*l)}var x=a(t,e,i,s),u=a(t,e,o,n);return x>u?u:x};if(n)e.showTooltip(n,s);else if(o.plotOptions.series.lines.show&&o.tooltipOptions.lines===!0){var p=o.plotOptions.grid.mouseActiveRadius,l={distance:p+1};t.each(e.getData(),function(t,i){for(var o=0,n=-1,p=1;p<i.data.length;p++)i.data[p-1][0]<=s.x&&i.data[p][0]>=s.x&&(o=p-1,n=p);if(n===-1)return void e.hideTooltip();var d={x:i.data[o][0],y:i.data[o][1]},x={x:i.data[n][0],y:i.data[n][1]},u=r(i.xaxis.p2c(s.x),i.yaxis.p2c(s.y),i.xaxis.p2c(d.x),i.yaxis.p2c(d.y),i.xaxis.p2c(x.x),i.yaxis.p2c(x.y),!1);if(u<l.distance){var f=a(d.x,d.y,s.x,s.y)<a(s.x,s.y,x.x,x.y)?o:n,c=(i.datapoints.pointsize,[s.x,d.y+(x.y-d.y)*((s.x-d.x)/(x.x-d.x))]),h={datapoint:c,dataIndex:f,series:i,seriesIndex:t};l={distance:u,item:h}}}),l.distance<p+1?e.showTooltip(l.item,s):e.hideTooltip()}else e.hideTooltip()}var o=this,n=t.plot.plugins.length;if(this.plotPlugins=[],n)for(var a=0;n>a;a++)this.plotPlugins.push(t.plot.plugins[a].name);e.hooks.bindEvents.push(function(e,n){if(o.plotOptions=e.getOptions(),o.plotOptions.tooltip!==!1&&"undefined"!=typeof o.plotOptions.tooltip){o.tooltipOptions=o.plotOptions.tooltipOpts,o.tooltipOptions.$compat?(o.wfunc="width",o.hfunc="height"):(o.wfunc="innerWidth",o.hfunc="innerHeight");{o.getDomElement()}t(e.getPlaceholder()).bind("plothover",s),t(n).bind("mousemove",i)}}),e.hooks.shutdown.push(function(e,o){t(e.getPlaceholder()).unbind("plothover",s),t(o).unbind("mousemove",i)}),e.setTooltipPosition=function(e){var i=o.getDomElement(),s=i.outerWidth()+o.tooltipOptions.shifts.x,n=i.outerHeight()+o.tooltipOptions.shifts.y;e.x-t(window).scrollLeft()>t(window)[o.wfunc]()-s&&(e.x-=s),e.y-t(window).scrollTop()>t(window)[o.hfunc]()-n&&(e.y-=n),o.tipPosition.x=e.x,o.tipPosition.y=e.y},e.showTooltip=function(t,i){var s=o.getDomElement(),n=o.stringFormat(o.tooltipOptions.content,t);s.html(n),e.setTooltipPosition({x:i.pageX,y:i.pageY}),s.css({left:o.tipPosition.x+o.tooltipOptions.shifts.x,top:o.tipPosition.y+o.tooltipOptions.shifts.y}).show(),"function"==typeof o.tooltipOptions.onHover&&o.tooltipOptions.onHover(t,s)},e.hideTooltip=function(){o.getDomElement().hide().html("")}},i.prototype.getDomElement=function(){var e=t("#"+this.tooltipOptions.id);return 0===e.length&&(e=t("<div />").attr("id",this.tooltipOptions.id),e.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&e.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"})),e},i.prototype.stringFormat=function(t,e){var i,s,o,n,a=/%p\.{0,1}(\d{0,})/,r=/%s/,p=/%lx/,l=/%ly/,d=/%x\.{0,1}(\d{0,})/,x=/%y\.{0,1}(\d{0,})/,u="%x",f="%y",c="%ct";if("undefined"!=typeof e.series.threshold?(i=e.datapoint[0],s=e.datapoint[1],o=e.datapoint[2]):"undefined"!=typeof e.series.lines&&e.series.lines.steps?(i=e.series.datapoints.points[2*e.dataIndex],s=e.series.datapoints.points[2*e.dataIndex+1],o=""):(i=e.series.data[e.dataIndex][0],s=e.series.data[e.dataIndex][1],o=e.series.data[e.dataIndex][2]),null===e.series.label&&e.series.originSeries&&(e.series.label=e.series.originSeries.label),"function"==typeof t&&(t=t(e.series.label,i,s,e)),"undefined"!=typeof e.series.percent?n=e.series.percent:"undefined"!=typeof e.series.percents&&(n=e.series.percents[e.dataIndex]),"number"==typeof n&&(t=this.adjustValPrecision(a,t,n)),t="undefined"!=typeof e.series.label?t.replace(r,e.series.label):t.replace(r,""),t=this.hasAxisLabel("xaxis",e)?t.replace(p,e.series.xaxis.options.axisLabel):t.replace(p,""),t=this.hasAxisLabel("yaxis",e)?t.replace(l,e.series.yaxis.options.axisLabel):t.replace(l,""),this.isTimeMode("xaxis",e)&&this.isXDateFormat(e)&&(t=t.replace(d,this.timestampToDate(i,this.tooltipOptions.xDateFormat,e.series.xaxis.options))),this.isTimeMode("yaxis",e)&&this.isYDateFormat(e)&&(t=t.replace(x,this.timestampToDate(s,this.tooltipOptions.yDateFormat,e.series.yaxis.options))),"number"==typeof i&&(t=this.adjustValPrecision(d,t,i)),"number"==typeof s&&(t=this.adjustValPrecision(x,t,s)),"undefined"!=typeof e.series.xaxis.ticks){var h;h=this.hasRotatedXAxisTicks(e)?"rotatedTicks":"ticks";var y=e.dataIndex+e.seriesIndex;if(e.series.xaxis[h].length>y&&!this.isTimeMode("xaxis",e)){var m=this.isCategoriesMode("xaxis",e)?e.series.xaxis[h][y].label:e.series.xaxis[h][y].v;m===i&&(t=t.replace(d,e.series.xaxis[h][y].label))}}if("undefined"!=typeof e.series.yaxis.ticks)for(var g in e.series.yaxis.ticks)if(e.series.yaxis.ticks.hasOwnProperty(g)){var v=this.isCategoriesMode("yaxis",e)?e.series.yaxis.ticks[g].label:e.series.yaxis.ticks[g].v;v===s&&(t=t.replace(x,e.series.yaxis.ticks[g].label))}return"undefined"!=typeof e.series.xaxis.tickFormatter&&(t=t.replace(u,e.series.xaxis.tickFormatter(i,e.series.xaxis).replace(/\$/g,"$$"))),"undefined"!=typeof e.series.yaxis.tickFormatter&&(t=t.replace(f,e.series.yaxis.tickFormatter(s,e.series.yaxis).replace(/\$/g,"$$"))),o&&(t=t.replace(c,o)),t},i.prototype.isTimeMode=function(t,e){return"undefined"!=typeof e.series[t].options.mode&&"time"===e.series[t].options.mode},i.prototype.isXDateFormat=function(){return"undefined"!=typeof this.tooltipOptions.xDateFormat&&null!==this.tooltipOptions.xDateFormat},i.prototype.isYDateFormat=function(){return"undefined"!=typeof this.tooltipOptions.yDateFormat&&null!==this.tooltipOptions.yDateFormat},i.prototype.isCategoriesMode=function(t,e){return"undefined"!=typeof e.series[t].options.mode&&"categories"===e.series[t].options.mode},i.prototype.timestampToDate=function(e,i,s){var o=t.plot.dateGenerator(e,s);return t.plot.formatDate(o,i,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)},i.prototype.adjustValPrecision=function(t,e,i){var s,o=e.match(t);return null!==o&&""!==RegExp.$1&&(s=RegExp.$1,i=i.toFixed(s),e=e.replace(t,i)),e},i.prototype.hasAxisLabel=function(e,i){return t.inArray("axisLabels",this.plotPlugins)!==-1&&"undefined"!=typeof i.series[e].options.axisLabel&&i.series[e].options.axisLabel.length>0},i.prototype.hasRotatedXAxisTicks=function(e){return t.inArray("tickRotor",this.plotPlugins)!==-1&&"undefined"!=typeof e.series.xaxis.rotatedTicks};var s=function(t){new i(t)};t.plot.plugins.push({init:s,options:e,name:"tooltip",version:"0.8.4"})}(jQuery);