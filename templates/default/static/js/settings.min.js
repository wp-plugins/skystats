jQuery(window).ready(function(e){var s=e("#skystats-settings-accordion");s.accordion({animate:"swing",collapsible:!0,header:"h3",heightStyle:"content",icons:{header:"skystats-accordion-header-icon",activeHeader:"skystats-accordion-header-active-icon"}}),"settings"===skystats_settings.active_accordion_section&&s.accordion("option","active",1),e("#validate_license").click(function(s){s.preventDefault();var t=e("#skystats-settings-validate-license-loading-container"),a=e("#skystats-successful-license-validation-request"),n=e("#skystats-unsuccessful-license-validation-request"),i=e(this),c=e("#license_key").val();e("#skystats-license-info-message").fadeOut(),a.add(n).add(i).fadeOut(400).promise().done(function(){t.fadeIn(400,function(){e.get(ajaxurl,{action:"skystats_ajax_licensing_validate_license",license_key:c},function(s){if(s=e.parseJSON(s),"success"===s.responseType){switch(e.post(ajaxurl,{action:"skystats_ajax_licensing_save_license_type",license_type:null!=s.data?s.data.licenseType:null}),s.responseContext){case"license_activated":a.html(skystats_settings.trans.licensing.license_activated);break;case"license_valid":default:a.html(skystats_settings.trans.licensing.license_valid)}t.fadeOut(400,function(){a.fadeIn(),i.fadeIn()})}else if("error"===s.responseType){switch(s.responseContext){case"missing_license_key":n.html(skystats_settings.trans.licensing.missing_license_key);break;case"error_initializing_request":n.html(skystats_settings.trans.licensing.error_initializing_request);break;case"error_executing_request":n.html(skystats_settings.trans.licensing.error_executing_request);break;case"malformed_response":n.html(skystats_settings.trans.licensing.malformed_response);break;case"license_site_inactive_no_activations_left":n.html(skystats_settings.trans.licensing.license_site_inactive_no_activations_left);break;case"license_site_inactive_activation_error":n.html(skystats_settings.trans.licensing.license_site_inactive_activation_error);break;case"license_inactive_no_activations_left":n.html(skystats_settings.trans.licensing.license_inactive_no_activations_left);break;case"license_inactive_activation_error":n.html(skystats_settings.trans.licensing.license_inactive_activation_error);break;case"license_expired":var r=skystats_settings.trans.licensing.license_expired;r=r.replace("{LICENSE_KEY}",c),n.html(r);break;case"license_disabled":n.html(skystats_settings.trans.licensing.license_disabled);break;case"http_error":n.html(skystats_settings.trans.licensing.http_error);break;case"license_unknown_status":default:n.html(skystats_settings.trans.licensing.license_unknown_status)}t.fadeOut(400,function(){n.fadeIn(),i.fadeIn()})}})})})});var t=[],a=[],n=[];e(".skystats-upload-image").each(function(s,i){var c=e(i),r=c.prev(),o=e(".skystats-loading-container").first().clone();o.attr("id",""),o.attr("style","margin-top: 10px;"),t[s]=c,a[s]=r,n[s]=r.parent().prev().children().first(),c.fileupload({dataType:"json",formData:{action:"skystats_ajax_upload_image"},url:ajaxurl,add:function(e,t){a[s].hide(),o.insertAfter(a[s]),o.show(),t.submit()},done:function(e,t){var i=t.result;o.remove(),i&&n[s].val(i),a[s].show()}})}),e("#save_settings").click(function(s){s.preventDefault();var t=e("#skystats-settings-save-settings-loading-container"),a=e(this),n=e("#skystats-save-settings-result"),i=e("#settings-reload");t.show(),a.add(i).add(n).fadeOut(400).promise().done(function(){t.fadeIn(400,function(){e.post(ajaxurl,{action:"skystats_ajax_settings_save_settings",brand_name:e("#brand_name").val(),brand_menu_name:e("#brand_menu_name").val(),brand_logo_image_url:e("#brand_logo_image_url").val(),brand_background_image_url:e("#brand_background_image_url").val(),brand_background_color:e("#brand_background_color").val(),role_access:e("#role_access").val(),default_dashboard:e("#default_dashboard").val(),cache_mode:e("#cache_mode").val(),vote_opt_in:e("#vote-opt-in").val()},function(){t.fadeOut(400,function(){n.add(a).add(i).fadeIn(400).promise().done(function(){})})})})})}),e("#settings-reload").click(function(){var s=e("#skystats-settings-save-settings-loading-container"),t=e("#save_settings"),a=e("#skystats-save-settings-result");e(this).add(t).add(a).fadeOut(400).promise().done(function(){s.fadeIn(400,function(){location.reload()})})}),skystats_settings.wp_version>="3.5"?e("#brand_background_color").wpColorPicker():e("#brand_background_color").ColorPicker({onChange:function(s,t,a,n){e(n);e("#brand_background_color").val("#"+t)},onSubmit:function(s,t,a,n){var i=e(n);i.val("#"+t),i.ColorPickerHide()}})});