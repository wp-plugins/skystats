jQuery(window).ready(function(s){var e=s("#skystats-settings-accordion");e.accordion({animate:"swing",collapsible:!0,header:"h3",heightStyle:"content",icons:{header:"skystats-accordion-header-icon",activeHeader:"skystats-accordion-header-active-icon"},create:function(e,t){s("#skystats_reports_users_allowed_access").chosen({width:"100%"}),s("#skystats_settings_users_allowed_access").chosen({width:"100%"})}}),"settings"===skystats_settings.active_accordion_section&&e.accordion("option","active",1),s("#validate_license").click(function(e){e.preventDefault();var t=s("#skystats-settings-validate-license-loading-container"),a=s("#skystats-successful-license-validation-request"),n=s("#skystats-unsuccessful-license-validation-request"),i=s(this),c=s("#license_key").val();s("#skystats-license-info-message").fadeOut(),a.add(n).add(i).fadeOut(400).promise().done(function(){t.fadeIn(400,function(){s.get(ajaxurl,{action:"skystats_ajax_licensing_validate_license",license_key:c},function(e){if(e=s.parseJSON(e),"success"===e.responseType){switch(s.post(ajaxurl,{action:"skystats_ajax_licensing_save_license_type",license_type:null!=e.data?e.data.licenseType:null}),e.responseContext){case"license_activated":a.html(skystats_settings.trans.licensing.license_activated);break;case"license_valid":default:a.html(skystats_settings.trans.licensing.license_valid)}t.fadeOut(400,function(){a.fadeIn(),i.fadeIn()})}else if("error"===e.responseType){switch(e.responseContext){case"license_invalid":n.html(skystats_settings.trans.licensing.license_invalid);break;case"missing_license_key":n.html(skystats_settings.trans.licensing.missing_license_key);break;case"error_initializing_request":n.html(skystats_settings.trans.licensing.error_initializing_request);break;case"error_executing_request":n.html(skystats_settings.trans.licensing.error_executing_request);break;case"malformed_response":n.html(skystats_settings.trans.licensing.malformed_response);break;case"license_site_inactive_no_activations_left":n.html(skystats_settings.trans.licensing.license_site_inactive_no_activations_left);break;case"license_site_inactive_activation_error":n.html(skystats_settings.trans.licensing.license_site_inactive_activation_error);break;case"license_inactive_no_activations_left":n.html(skystats_settings.trans.licensing.license_inactive_no_activations_left);break;case"license_inactive_activation_error":n.html(skystats_settings.trans.licensing.license_inactive_activation_error);break;case"license_expired":var r=skystats_settings.trans.licensing.license_expired;r=r.replace("{LICENSE_KEY}",c),n.html(r);break;case"license_disabled":n.html(skystats_settings.trans.licensing.license_disabled);break;case"http_error":n.html(skystats_settings.trans.licensing.http_error);break;case"license_unknown_status":default:n.html(skystats_settings.trans.licensing.license_unknown_status)}t.fadeOut(400,function(){n.fadeIn(),i.fadeIn()})}})})})});var t=[],a=[],n=[];s(".skystats-upload-image").each(function(e,i){var c=s(i),r=c.prev(),l=s(".skystats-loading-container").first().clone();l.attr("id",""),l.attr("style","margin-top: 10px;"),t[e]=c,a[e]=r,n[e]=r.parent().prev().children().first(),c.fileupload({dataType:"json",formData:{action:"skystats_ajax_upload_image"},url:ajaxurl,add:function(s,t){a[e].hide(),l.insertAfter(a[e]),l.show(),t.submit()},done:function(s,t){var i=t.result;l.remove(),i&&n[e].val(i),a[e].show()}})}),s("#save_settings").click(function(e){e.preventDefault();var t=s("#skystats-settings-save-settings-loading-container"),a=s(this),n=s("#skystats-save-settings-result"),i=s("#settings-reload");t.show(),a.add(i).add(n).fadeOut(400).promise().done(function(){t.fadeIn(400,function(){s.post(ajaxurl,{action:"skystats_ajax_settings_save_settings",role_access:s("#role_access").val(),default_dashboard:s("#default_dashboard").val(),cache_mode:s("#cache_mode").val(),skystats_reports_users_allowed_access:s("#skystats_reports_users_allowed_access").val(),skystats_settings_users_allowed_access:s("#skystats_settings_users_allowed_access").val()},function(){t.fadeOut(400,function(){n.add(a).add(i).fadeIn(400).promise().done(function(){})})})})})}),skystats_settings.wp_version>="3.5"?s("#brand_background_color").wpColorPicker():s("#brand_background_color").ColorPicker({onChange:function(e,t,a,n){s(n);s("#brand_background_color").val("#"+t)},onSubmit:function(e,t,a,n){var i=s(n);i.val("#"+t),i.ColorPickerHide()}})});